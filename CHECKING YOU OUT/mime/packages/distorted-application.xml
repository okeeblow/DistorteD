<?xml version="1.0" encoding="UTF-8"?>

<mime-info>
  <!--
    https://www.loc.gov/preservation/digital/formats/fdd/fdd000440.shtml
    http://justsolve.archiveteam.org/wiki/MAT
  -->
  <mime-type type="application/x-matlab-data">
    <magic priority="50">
      <match type="string" value="MATLAB 5.0 MAT-file" offset="0"/>
      <match type="string" value="MATLAB 7.0 MAT-file" offset="0"/>
    </magic>
    <glob pattern="*.mat"/>
  </mime-type>

  <!--
    http://fileformats.archiveteam.org/wiki/Linear_Executable
    http://www.textfiles.com/programming/FORMATS/lxexe.txt
    https://open-watcom.github.io/open-watcom-v2-wikidocs/lguide.html#OSD2__The_OSD2_Executable_and_DLL_File_Formats
    https://moddingwiki.shikadi.net/wiki/Linear_Executable_(LX/LE)_Format
    http://www.edm2.com/index.php/LX_-_Linear_eXecutable_Module_Format_Description
    https://github.com/uxmal/reko/blob/master/src/ImageLoaders/MzExe/ExeImageLoader.cs
    https://faydoc.tripod.com/formats/exe-LE.htm
  -->
  <mime-type type="application/x-linear-executable">
    <sub-class-of type="application/x-ms-dos-executable"/>
    <comment>OS∕2 executable, DOS extender, or Windows VxD</comment>
    <magic priority="55">
      <match type="string" value="MZ" offset="0">
        <!--
          These definitions are incomplete because the LE header is at an offset given *in* a known offset.
          For now I will just assume it's at 0x80 since I don't think s-m-i supports offset offsets:

          ```[okeeblow@emi#x-linear-executable] xxd -s 0x80 CYO-VAB1.EXE| head -n 1
          00000080: 4c58 0000 0000 0000 0200 0100 0000 0200  LX..............```
        -->
        <match type="string" value="LX" offset="128"/>  <!-- 32-bit -->
        <match type="string" value="LE" offset="128"/>  <!-- mixed 16/32-bit -->
      </match>
    </magic>
    <glob pattern="*.exe"/>
    <glob pattern="*.386"/>
    <glob pattern="*.dll"/>
    <glob pattern="*.sys"/>
    <glob pattern="*.vxd"/>
  </mime-type>

  <mime-type type="application/msword">
    <glob pattern="*.mcw"/>  <!-- Microsoft Word for Macintosh document -->
  </mime-type>

  <!-- See `write.txt` in the relevant documentation directory -->
  <mime-type type="application/x-mswrite">
    <magic priority="33">
      <match type="little16" value="0xbe31">  <!-- non-OLE -->
        <match type="little16" value="0x0000" offset="2">
          <match type="little16" value="0xab00" offset="4"/>
        </match>
      </match>
      <match type="little16" value="0xbe32">  <!-- OLE -->
        <match type="little16" value="0x0000" offset="2">
          <match type="little16" value="0xab00" offset="4"/>
        </match>
      </match>
    </magic>
  </mime-type>

  <mime-type type="application/dca-rft">
    <glob pattern="*.rft"/>
  </mime-type>

  <!--
    http://fileformats.archiveteam.org/wiki/CorelDRAW
    https://en.wikipedia.org/wiki/CorelDRAW#file_format
    "From version X4 (14) on, the CDR file is a ZIP-compressed directory of several files",
    which this definition currently does not cover.
  -->
  <mime-type type="application/vnd.corel-draw">
    <glob pattern="*.cdt"/>  <!-- CorelDRAW Template -->
  </mime-type>

  <!--
    `application/x-stuffitx` also used by Apache httpd: https://bz.apache.org/bugzilla/show_bug.cgi?id=38009
  -->
  <mime-type type="application/x-stuffitx">
    <comment>StuffIt X archive</comment>
    <generic-icon name="package-x-generic"/>
    <magic priority="60">
      <match type="string" value="StuffIt!" offset="0"/>
    </magic>
    <glob pattern="*.sitx"/>
  </mime-type>

  <!--
    http://fileformats.archiveteam.org/wiki/AppleWorks
  -->
  <mime-type type="application/x-appleworks-document">
    <!--<cyo:fourcc type="string" pattern="BOBO" offset="4"/>  Creator code -->
  </mime-type>

  <!--
    http://fileformats.archiveteam.org/wiki/Compact_Pro
    http://www.cyclos.com/compactpro.htm
  -->
  <mime-type type="application/mac-compactpro">
    <!--
      "The only magic number in a Compact Pro file header is the first byte 01.
       The rest is offsets for the file directory and data, along with CRC-32 values."
      "The type code is PACT, and the creator code is CPCT which sometimes can be found
       in the file if the file has been encoded as a MacBinary file."
    -->
    <glob pattern="*.sea"/>
    <cyo:fourcc type="string" pattern="PACT"/>
  </mime-type>

  <!--
    http://fileformats.archiveteam.org/wiki/Adobe_Illustrator_Artwork
    https://www.fileformat.info/format/ai/egff.htm
  -->
  <mime-type type="application/illustrator">
    <sub-class-of type="application/postscript"/>
  </mime-type>

  <!--
    https://web.archive.org/web/20060412163212/https://partners.adobe.com/public/developer/en/illustrator/sdk/AI7FileFormat.pdf
  -->
  <mime-type type="application/postscript">
    <magic priority="33">
      <!--
        Per `AI7FileFormat.pdf`, "The documents (files) created by Adobe Illustrator are PostScript language documents.",
        and the `Prolog` BNF syntax tells us what to match:

        "`%!PS-Adobe-*M* EPSF-*N*` (or `%!PS-Adobe-*M*`)  — The first line of the file is a unique comment that identifies
         the version of the Document Structuring Conventions (DSC) to which the document conforms.
         The first line may also specify that the file conforms to a version of the Encapsulated PostScript File format (EPSF).
         Both numbers must correspond to the specific versions used in writing out the file. For example,
         the comment `%!PS-Adobe-3.0 EPSF-3.0` indicates that the file conforms to DSC version 3.0 and EPSF version 3.0."

          irb> "%!PS-Adobe-X.X".each_char.reduce(0) { (_1 << 8) | _2.ord } & 0xffffffffffffffffffffff00ff00
          => 753088544053424031651592780393984
          irb> "%!PS-Adobe-3.0".each_char.reduce(0) { (_1 << 8) | _2.ord } & 0xffffffffffffffffffffff00ff00
          => 753088544053424031651592780393984
      -->
      <match type="string" offset="0" value="%!PS-Adobe-X.X" mask="0xffffffffffffffffffffff00ff00"/>
    </magic>
  </mime-type>

  <!--
    http://fileformats.archiveteam.org/wiki/TOAST
  -->
  <mime-type type="application/x-roxio-toast">
    <sub-class-of type="application/x-cd-image"/>
    <!--
      "Early versions of Toast software would save a disc image with no extension,
       as was common for Macintosh systems, but would add `•image` to the end.
       Starting In Toast 5.1 (2002), the extension `.toast` was added,
       probably to be compatible with Mac OS X."
    -->
    <glob pattern="*•image"/>
    <glob pattern="*.toast"/>
    <magic priority="22">
      <!--
        "Early •image & .toast files begin with the hex values `45 52 02 00`.
         Later versions don't seem to have this header."
        CYO's Toast 5.0.2 example image has this header.
      -->
      <match type="big32" offset="0" value="0x45520200"/>
    </magic>
    <magic priority="77">
      <!--
         Earlier versions tag "Miles Software" (Dr. Markus Fest's company), then the start-year resets
         to 1997 when Adaptec bought Toast, and the end-year seems to increment along with each release:
         `TOAST ISO 9660 BUILDER COPYRIGHT (C) 1993 MILES SOFTWARE ENGINEERING - HAVE A NICE DAY`
         `TOAST ISO 9660 BUILDER COPYRIGHT (C) 1993-1995 MILES SOFTWARE ENGINEERING - HAVE A NICE DAY`
         `TOAST ISO 9660 BUILDER COPYRIGHT (C) 1993-1996 MILES SOFTWARE GMBH - HAVE A NICE DAY`
         `TOAST ISO 9660 BUILDER COPYRIGHT (C) 1997 ADAPTEC, INC. - HAVE A NICE DAY`
         `TOAST ISO 9660 BUILDER COPYRIGHT (C) 1997-2002 ROXIO, INC. - HAVE A NICE DAY`
         `TOAST ISO 9660 BUILDER COPYRIGHT (C) 1997-2003 ROXIO, INC. - HAVE A NICE DAY`
         `TOAST ISO 9660 BUILDER COPYRIGHT (C) 1997-2005 SONIC SOLUTIONS, INC. - HAVE A NICE DAY`
         `TOAST ISO 9660 BUILDER COPYRIGHT (C) 1997-2011 SONIC SOLUTIONS - HAVE A NICE DAY`
      -->
      <match type="string" offset="0" value="TOAST ISO 9660 BUILDER COPYRIGHT"/>
    </magic>
    <cyo:fourcc type="string" pattern="Hlmg"/>
  </mime-type>

  <!--
    http://fileformats.archiveteam.org/wiki/Fontographer
  -->
  <mime-type type="application/x-fontographer">
    <glob pattern="*.fog"/>
    <magic priority="44">
      <match type="big32" offset="0" value="0x43666631"/>
    </magic>
    <generic-icon name="font-x-generic"/>
  </mime-type>

  <!--
    http://fileformats.archiveteam.org/wiki/Adobe_Type_1
  -->
  <mime-type type="application/x-font-type1">
    <glob pattern="*.pfm"/>  <!-- Printer Font Metrics -->
  </mime-type>

  <!--
    https://pkware.cachefly.net/webdocs/casestudies/APPNOTE.TXT
    http://fileformats.archiveteam.org/wiki/ZIP
  -->
  <mime-type type="application/zip">
    <magic priority="60">
      <!--
        The fd.o package defines a match for the common "PK\003\004" start-sequence,
        but not for the mandatory "end of central directory" signature.

        Per `APPNOTE.TXT`:
          "A ZIP file MUST contain an 'end of central directory record'.
           A ZIP file containing only an 'end of central directory record' is considered an empty ZIP file.
           A ZIP file MUST have only one 'end of central directory record'."
      -->
      <!-- TODO: Support this. -->
      <!--<match type="string" value="PK\005\006" offset="-0"/>-->
    </magic>
    <!-- Per `APPNOTE.TXT`: "Use of the extension `.ZIPX` is also recognized and MAY be used for ZIP files." -->
    <glob pattern="*.zipx"/>
  </mime-type>

  <!--
    http://fileformats.archiveteam.org/wiki/SWF

    NOTE: The Flash browser plugin apparently does not declare support for the `vnd.adobe.flash.movie` type,
          only for the `futuresplash` and `x-shockwave-flash` aliases:
          https://www.mail-archive.com/debian-bugs-dist@lists.debian.org/msg1797351.html
  -->
  <mime-type type="application/vnd.adobe.flash.movie">
    <magic priority="50">
      <!--
        The fd.o package declares the uncompressed `FWS` and the `CWS` zlib-compressed sequence
        but was missing the `ZWS` LZMA-compressed sequence: http://fileformats.archiveteam.org/wiki/SWF#Identification
      -->
      <match type="string" value="ZWS" offset="0"/>
    </magic>
  </mime-type>

  <!--
    Microsoft "Channel Definition Format" — Used for Channels in IE4 and Offline Favorites in IE5.

    Modern documentation:
    https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768137(v=vs.85)

    Ye Olde Docere:
    http://xml.coverpages.org/cdf970314.html
    https://web.archive.org/web/19991013120513/http://msdn.microsoft.com/workshop/delivery/cdf/tutorials/generic.asp
    https://www.w3.org/TR/NOTE-CDFsubmit.html
    https://people.apache.org/~jim/NewArchitect/webrevu/1997/09_12/webauthors/09_12_97_5.html

    This is *not* related to NASA's 1980s "Common Data Format":
    https://en.wikipedia.org/wiki/Common_Data_Format

    It doesn't seem to be registered, but software like WolframAlpha use `application/cdf` for NASA's CDF:
    https://bugs.python.org/issue31867#msg304979

    This is *not* related to the XML format `application/cdfx+xml` describing mechanical calibration data:
    https://www.iana.org/assignments/media-types/application/CDFX+XML

    This is *not* related to W3C's dead "Compound Document Format" whose spec proposes `application/cdf+xml`:
    https://www.w3.org/2004/CDF/specs/CDI/cdi-framework/Indentification.src.html
    https://arstechnica.com/uncategorized/2007/10/opendocument-foundation-drops-support-for-odf-backs-obscure-w3c-format/

    According to a 1997 e-mail from Microsoft, the registration process for `application/cdf` was underway
    and "Internet Explorer will support [`application/x-cdf`] forever."
    http://scripting.com/davenet/stories/MIMEtypeforCDF.html

    I can find no evidence the '90s `application/cdf` registration was ever granted,
    and W3C's 2004 draft Common Document Format proposal makes it difficult to search for.
    Presumably W3C would not have proposed `application/cdf` in 2004 for Compound Document Format
    if it had already been registered by Microsoft in 1998 for Channel Definition Format.

    Microsoft's C# `System.Web.MimeMapping` only defines `application/x-cdf` for `*.cdf` files,
    so I'm going to define that as the main type here and leave `application/cdf` to NASA's Common Data Format:
    https://referencesource.microsoft.com/#System.Web/MimeMapping.cs,133
  -->
  <mime-type type="application/x-cdf">
    <comment>Microsoft Active Channel definition file</comment>
    <acronym>CDF</acronym>
    <expanded-acronym>Channel Definition Format</expanded-acronym>
    <generic-icon name="text-html"/>
    <!--
      This format predates the XML 1.0 standard and does not define a `namespaceURI`,
      something currently required by `shared-mime-info`'s `<root-XML/>`.

      I have also found example Channel Definition Files which seem to be
      SGML-based instead of the proto-XML, e.g.:
      https://sceweb.uhcl.edu/liaw/odi/osji/COM/odi/demo/xml/samples/Channel.xml

      Note the SGML-style empty end-tags (`</>`) and lack of `<?xml?>` prolog.
      I need to confirm the behavior of these in IE4/IE5 before explicitly declaring this
      as an XML sub-format.
    <sub-class-of type="application/xml"/>
    <root-XML localName="channel"/>
    -->
    <glob pattern="*.cdf" weight="55"/>  <!-- NetCDF has `*.cdf` weight 50 -->
  </mime-type>

  <!--
    Example of second two bytes indicating RIFF chunk length
    which should also be the (file length - 8):

    [okeeblow@emi#x-director] xxd -l 40 director_11.5_wintel.dcr
    00000000: 5846 4952 f911 0000 4d44 4746 7265 7646  XFIR....MDGFrevF
    00000010: 108a 0101 8f03 0a31 312e 352e 3923 3632  .......11.5.9#62
    00000020: 3972 6463 4651 78da                      9rdcFQx.

    [okeeblow@emi#x-director] xxd -l 40 director_11.5_wintel.dir
    00000000: 5846 4952 ee33 0000 3339 564d 7061 6d69  XFIR.3..39VMpami
    00000010: 1800 0000 0100 0000 2c00 0000 8307 0000  ........,.......
    00000020: 0000 0000 0000 0000                      ........

    [okeeblow@emi#x-director] ls -l
    total 24
    -rw-rw-rw- 1 okeeblow okeeblow  4609 Oct 17 17:01 director_11.5_wintel.dcr
    -rw-rw-rw- 1 okeeblow okeeblow 13302 Oct 17 17:01 director_11.5_wintel.dir

    irb(main):029:0> 0x000011f9
    => 4601
    irb(main):030:0> 0x000033ee
    => 13294
  -->
  <mime-type type="application/x-riff">
    <magic priority="45">
      <match type="string" value="RIFX" offset="0"/>
      <match type="string" value="XFIR" offset="0"/>
    </magic>
  </mime-type>

  <mime-type type="application/x-director">
    <comment>Adobe Shockwave Director</comment>
    <sub-type-of type="application/x-riff"/>
    <generic-icon name="video-x-generic"/>
    <glob pattern="*.dir"/>
    <glob pattern="*.dcr"/>
    <glob pattern="*.dxr"/>
    <glob pattern="*.drx"/>
    <glob pattern="*.cst"/>
    <glob pattern="*.cxt"/>
    <glob pattern="*.cct"/>
    <magic>
      <!-- RIFX -->
      <match type="string" value="MV93" offset="8"/>  <!-- Director 4.0 -->
      <match type="string" value="MV95" offset="8"/>  <!-- Director 5.0 -->
      <match type="string" value="M!95" offset="8"/>
      <match type="string" value="MV85" offset="8"/>  <!-- Director 8.5 -->
      <!-- XFIR -->
      <match type="string" value="39VM" offset="8"/>
      <match type="string" value="59VM" offset="8"/>
      <match type="string" value="59!M" offset="8"/>
      <match type="string" value="58MV" offset="8"/>
    </magic>
  </mime-type>

</mime-info>

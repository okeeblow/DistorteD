<?xml version="1.0" encoding="UTF-8"?>

<mime-info>
  <!--
    https://www.loc.gov/preservation/digital/formats/fdd/fdd000440.shtml
    http://justsolve.archiveteam.org/wiki/MAT
  -->
  <mime-type type="application/x-matlab-data">
    <magic priority="50">
      <match type="string" value="MATLAB 5.0 MAT-file" offset="0"/>
      <match type="string" value="MATLAB 7.0 MAT-file" offset="0"/>
    </magic>
    <glob pattern="*.mat"/>
  </mime-type>

  <!--
    http://fileformats.archiveteam.org/wiki/Linear_Executable
    http://www.textfiles.com/programming/FORMATS/lxexe.txt
    https://open-watcom.github.io/open-watcom-v2-wikidocs/lguide.html#OSD2__The_OSD2_Executable_and_DLL_File_Formats
    https://moddingwiki.shikadi.net/wiki/Linear_Executable_(LX/LE)_Format
    http://www.edm2.com/index.php/LX_-_Linear_eXecutable_Module_Format_Description
    https://github.com/uxmal/reko/blob/master/src/ImageLoaders/MzExe/ExeImageLoader.cs
    https://faydoc.tripod.com/formats/exe-LE.htm
  -->
  <mime-type type="application/x-linear-executable">
    <sub-class-of type="application/x-ms-dos-executable"/>
    <comment>OS∕2 executable, DOS extender, or Windows VxD</comment>
    <magic priority="55">
      <match type="string" value="MZ" offset="0">
        <!--
          These definitions are incomplete because the LE header is at an offset given *in* a known offset.
          For now I will just assume it's at 0x80 since I don't think s-m-i supports offset offsets:

          ```[okeeblow@emi#x-linear-executable] xxd -s 0x80 CYO-VAB1.EXE| head -n 1
          00000080: 4c58 0000 0000 0000 0200 0100 0000 0200  LX..............```
        -->
        <match type="string" value="LX" offset="128"/>  <!-- 32-bit -->
        <match type="string" value="LE" offset="128"/>  <!-- mixed 16/32-bit -->
      </match>
    </magic>
    <glob pattern="*.exe"/>
    <glob pattern="*.386"/>
    <glob pattern="*.dll"/>
    <glob pattern="*.sys"/>
    <glob pattern="*.vxd"/>
  </mime-type>

  <mime-type type="application/msword">
    <glob pattern="*.mcw"/>  <!-- Microsoft Word for Macintosh document -->
  </mime-type>

  <!-- See `write.txt` in the relevant documentation directory -->
  <mime-type type="application/x-mswrite">
    <magic priority="33">
      <match type="little16" value="0xbe31">  <!-- non-OLE -->
        <match type="little16" value="0x0000" offset="2">
          <match type="little16" value="0xab00" offset="4"/>
        </match>
      </match>
      <match type="little16" value="0xbe32">  <!-- OLE -->
        <match type="little16" value="0x0000" offset="2">
          <match type="little16" value="0xab00" offset="4"/>
        </match>
      </match>
    </magic>
  </mime-type>

  <mime-type type="application/dca-rft">
    <glob pattern="*.rft"/>
  </mime-type>

  <!--
    http://fileformats.archiveteam.org/wiki/CorelDRAW
    https://en.wikipedia.org/wiki/CorelDRAW#file_format
    "From version X4 (14) on, the CDR file is a ZIP-compressed directory of several files",
    which this definition currently does not cover.
  -->
  <mime-type type="application/vnd.corel-draw">
    <glob pattern="*.cdt"/>  <!-- CorelDRAW Template -->
  </mime-type>

  <!--
    `application/x-stuffitx` also used by Apache httpd: https://bz.apache.org/bugzilla/show_bug.cgi?id=38009
  -->
  <mime-type type="application/x-stuffitx">
    <comment>StuffIt X archive</comment>
    <generic-icon name="package-x-generic"/>
    <magic priority="60">
      <match type="string" value="StuffIt!" offset="0"/>
    </magic>
    <glob pattern="*.sitx"/>
  </mime-type>

  <!--
    http://fileformats.archiveteam.org/wiki/AppleWorks
  -->
  <mime-type type="application/x-appleworks-document">
    <!--<cyo:fourcc type="string" pattern="BOBO" offset="4"/>  Creator code -->
  </mime-type>

  <!--
    http://fileformats.archiveteam.org/wiki/Compact_Pro
    http://www.cyclos.com/compactpro.htm
  -->
  <mime-type type="application/mac-compactpro">
    <!--
      "The only magic number in a Compact Pro file header is the first byte 01.
       The rest is offsets for the file directory and data, along with CRC-32 values."
      "The type code is PACT, and the creator code is CPCT which sometimes can be found
       in the file if the file has been encoded as a MacBinary file."
    -->
    <glob pattern="*.sea"/>
    <cyo:fourcc type="string" pattern="PACT"/>
  </mime-type>

  <!--
    http://fileformats.archiveteam.org/wiki/Adobe_Illustrator_Artwork
    https://www.fileformat.info/format/ai/egff.htm
  -->
  <mime-type type="application/illustrator">
    <sub-class-of type="application/postscript"/>
  </mime-type>

  <!--
    https://web.archive.org/web/20060412163212/https://partners.adobe.com/public/developer/en/illustrator/sdk/AI7FileFormat.pdf
  -->
  <mime-type type="application/postscript">
    <magic priority="33">
      <!--
        Per `AI7FileFormat.pdf`, "The documents (files) created by Adobe Illustrator are PostScript language documents.",
        and the `Prolog` BNF syntax tells us what to match:

        "`%!PS-Adobe-*M* EPSF-*N*` (or `%!PS-Adobe-*M*`)  — The first line of the file is a unique comment that identifies
         the version of the Document Structuring Conventions (DSC) to which the document conforms.
         The first line may also specify that the file conforms to a version of the Encapsulated PostScript File format (EPSF).
         Both numbers must correspond to the specific versions used in writing out the file. For example,
         the comment `%!PS-Adobe-3.0 EPSF-3.0` indicates that the file conforms to DSC version 3.0 and EPSF version 3.0."

          irb> "%!PS-Adobe-X.X".each_char.reduce(0) { (_1 << 8) | _2.ord } & 0xffffffffffffffffffffff00ff00
          => 753088544053424031651592780393984
          irb> "%!PS-Adobe-3.0".each_char.reduce(0) { (_1 << 8) | _2.ord } & 0xffffffffffffffffffffff00ff00
          => 753088544053424031651592780393984
      -->
      <match type="string" offset="0" value="%!PS-Adobe-X.X" mask="0xffffffffffffffffffffff00ff00"/>
    </magic>
  </mime-type>

  <!--
    http://fileformats.archiveteam.org/wiki/TOAST
  -->
  <mime-type type="application/x-roxio-toast">
    <sub-class-of type="application/x-cd-image"/>
    <!--
      "Early versions of Toast software would save a disc image with no extension,
       as was common for Macintosh systems, but would add `•image` to the end.
       Starting In Toast 5.1 (2002), the extension `.toast` was added,
       probably to be compatible with Mac OS X."
    -->
    <glob pattern="*•image"/>
    <glob pattern="*.toast"/>
    <magic priority="22">
      <!--
        "Early •image & .toast files begin with the hex values `45 52 02 00`.
         Later versions don't seem to have this header."
        CYO's Toast 5.0.2 example image has this header.
      -->
      <match type="big32" offset="0" value="0x45520200"/>
    </magic>
    <magic priority="77">
      <!--
         Earlier versions tag "Miles Software" (Dr. Markus Fest's company), then the start-year resets
         to 1997 when Adaptec bought Toast, and the end-year seems to increment along with each release:
         `TOAST ISO 9660 BUILDER COPYRIGHT (C) 1993 MILES SOFTWARE ENGINEERING - HAVE A NICE DAY`
         `TOAST ISO 9660 BUILDER COPYRIGHT (C) 1993-1995 MILES SOFTWARE ENGINEERING - HAVE A NICE DAY`
         `TOAST ISO 9660 BUILDER COPYRIGHT (C) 1993-1996 MILES SOFTWARE GMBH - HAVE A NICE DAY`
         `TOAST ISO 9660 BUILDER COPYRIGHT (C) 1997 ADAPTEC, INC. - HAVE A NICE DAY`
         `TOAST ISO 9660 BUILDER COPYRIGHT (C) 1997-2002 ROXIO, INC. - HAVE A NICE DAY`
         `TOAST ISO 9660 BUILDER COPYRIGHT (C) 1997-2003 ROXIO, INC. - HAVE A NICE DAY`
         `TOAST ISO 9660 BUILDER COPYRIGHT (C) 1997-2005 SONIC SOLUTIONS, INC. - HAVE A NICE DAY`
         `TOAST ISO 9660 BUILDER COPYRIGHT (C) 1997-2011 SONIC SOLUTIONS - HAVE A NICE DAY`
      -->
      <match type="string" offset="0" value="TOAST ISO 9660 BUILDER COPYRIGHT"/>
    </magic>
    <cyo:fourcc type="string" pattern="Hlmg"/>
  </mime-type>

</mime-info>
